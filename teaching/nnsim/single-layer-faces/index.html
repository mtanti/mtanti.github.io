<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Neural network simulator</title>
    <script src="../res/scripts/library.js"></script>
    <script src="script.js"></script>
    <link rel="stylesheet" href="../res/styles/style.css" />
</head>
<body onload="onloadFunction();">

    <h1>Neural network simulator</h1>
    <p style="text-align: justify;">All images were taken from the <a href="https://www.kaggle.com/datasets/jessicali9530/lfw-dataset/">Labelled Faces in the Wild</a> data set.</p>

    <hr />

    <table id="faces_instance">
        <tr>
            <td colspan="3">
                <h2 style="text-align: center;">The neural network</h2>
                <p style="text-align: justify;">
                    A neural network is a kind of program that converts an input into an output.
                    It consists of a bunch of adjustable knobs called parameters which change how a set of inputs are converted into an output.
                    There are two types of parameters: weights and biases.
                    Weights indicate how important each input's value is to produce a bigger output whilst the bias adjusts the base output regardless of the inputs.
                    Zero weights are ignored, positive weights contribute to making the output bigger, and negatives weights contribute to making the output smaller.
                </p>
                <p style="text-align: justify;">
                    Adjust the weights (slanted sliders) and bias (verticle slider) below to change the output of the two neural networks below (the output is visually represented by the brightness of the border).
                    Each neural network is being fed different inputs, called features, according to what describes the person in the photo.
                    The values of the features are shown in parentheses next to their names.
                    An input value of zero, just like a weight of zero, does not contribute anything to the output.
                    What's happening is that each input is being multiplied by its corresponding weight number and then the total of each multiplication is added to the bias number and that result is what the output is based on (large results bring the output closer to 1 and small results bring the output closer to 0).
                </p>
                <p style="text-align: justify;">
                    Adjust the sliders so that the woman gets a large output (bright border) and the man gets a small output (dark border).
                    Can you make the the sliders exactly the same for both people while still obtaining the right output for both?
                </p>
            </td>
        </tr>
        <tr>
            <td style="width: 170px;">
                <table class="attributes">
                    <tr><td style="text-align: right;">Glasses (0)</td></tr>
                    <tr><td style="text-align: right;">Long hair (1)</td></tr>
                    <tr><td style="text-align: right;">Beard (0)</td></tr>
                    <tr><td style="text-align: right;">Necklace (0)</td></tr>
                </table>
            </td>
            <td style="width: 510px;">
                <div id="faces_instance1_canvas" class="canvas"></div>
            </td>
            <td style="width: 150px;">
                <img id="faces_instance1_img" src="../res/images/faces/1.jpg" />
                <div style="text-align: center; font-size: 20px;">Output: <span id="faces_instance1_output"><span></td>
            </td>
        </tr>
        <tr>
            <td style="width: 170px;">
                <table class="attributes">
                    <tr><td style="text-align: right;">Glasses (0)</td></tr>
                    <tr><td style="text-align: right;">Long hair (1)</td></tr>
                    <tr><td style="text-align: right;">Beard (1)</td></tr>
                    <tr><td style="text-align: right;">Necklace (0)</td></tr>
                </table>
            </td>
            <td style="width: 510px;">
                <div id="faces_instance2_canvas" class="canvas"></div>
            </td>
            <td style="width: 150px;">
                <img id="faces_instance2_img" src="../res/images/faces/2.jpg" />
                <div style="text-align: center; font-size: 20px;">Output: <span id="faces_instance2_output"><span></td>
            </td>
        </tr>
    </table>

    <hr />

    <table id="faces_human">
        <tr>
            <td colspan="3">
                <h2 style="text-align: center;">Optimisation: Human friendly version</h2>
                <p style="text-align: justify;">
                    Neural networks are not typically meant to work on just one input but on an entire train set of inputs.
                    The process of finding the right parameters to make a neural network give the right output for as many inputs in the train set as possible is called optimisation or training.
                </p>
                <p style="text-align: justify;">
                    Adjust the weights and bias below to make all the women have a light border and all the men have a dark border.
                </p>
            </td>
        </tr>
        <tr>
            <td style="width: 170px;">
                <table class="attributes">
                    <tr><td style="text-align: right;">Glasses<br />(0 or 1)</td></tr>
                    <tr><td style="text-align: right;">Long hair<br />(0 or 1)</td></tr>
                    <tr><td style="text-align: right;">Beard<br />(0 or 1)</td></tr>
                    <tr><td style="text-align: right;">Necklace<br />(0 or 1)</td></tr>
                </table>
            </td>
            <td style="width: 510px;">
                <div id="faces_human_canvas" class="canvas"></div>
            </td>
            <td style="width: 305px;">
                <table class="faces">
                    <tr>
                        <td style="text-align: center;">make light</td>
                        <td style="text-align: center;">make dark</td>
                    </tr>
                    <tr>
                        <td><img id="faces_human_img1" src="../res/images/faces/1.jpg" /></td>
                        <td><img id="faces_human_img2" src="../res/images/faces/2.jpg" /></td>
                    </tr>
                    <tr>
                        <td><img id="faces_human_img3" src="../res/images/faces/3.jpg" /></td>
                        <td><img id="faces_human_img4" src="../res/images/faces/4.jpg" /></td>
                    </tr>
                    <tr>
                        <td><img id="faces_human_img5" src="../res/images/faces/5.jpg" /></td>
                        <td><img id="faces_human_img6" src="../res/images/faces/6.jpg" /></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <hr />

    <table id="faces_human_test">
        <tr>
            <td colspan="3">
                <h2 style="text-align: center;">Testing the neural network</h2>
                <p style="text-align: justify;">
                    Just getting the best results on the train set does not mean much.
                    The point of the neural network is not to give the correct outputs for the inputs in the train set but for any input it is given.
                    We need the neural network to have been set in such a way that it gets the general gist of the train set rather than hyper-focuses on it.
                </p>
                <p style="text-align: justify;">
                    To check that the trained neural network is useful outside of the train set, we need to have a 'held-out' test set which was not used to train the neural network.
                    If it performs well on the train set but badly on the test set, we say that the neural network has overfitted on the train set.
                    If it performs well on both, we say that it has correctly generalised the train set.
                    Below is the output you get for the above neural network when applied to four new faces.
                </p>
            </td>
        </tr>
        <tr>
            <td style="width: 170px;">&nbsp;</td>
            <td style="width: 510px;">&nbsp;</td>
            <td style="width: 305px;">
                <table class="faces">
                    <tr>
                        <td style="text-align: center;">make light</td>
                        <td style="text-align: center;">make dark</td>
                    </tr>
                    <tr>
                        <td><img id="faces_human_img7" src="../res/images/faces/7.jpg" /></td>
                        <td><img id="faces_human_img8" src="../res/images/faces/8.jpg" /></td>
                    </tr>
                    <tr>
                        <td><img id="faces_human_img9" src="../res/images/faces/9.jpg" /></td>
                        <td><img id="faces_human_img10" src="../res/images/faces/10.jpg" /></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <hr />

    <table id="faces_computer">
        <tr>
            <td colspan="3" style="text-align: center;">
                <h2>Optimisation: Computer friendly version</h2>
                <p style="text-align: justify;">
                    This is the same thing as above except that this is closer to how a computer would do it.
                    The parameters can only be changed by a small amount at a time and you are only guided by a numeric error value.
                    The error is a number measuring how wrong the output of each train set item is.
                    The further the output is from the target, the greater the error will be.
                    This error is the only thing guiding a computer when training a neural network.
                    To make things simpler, the average of all the errors is used as a guide and the parameters need to be adjusted in such a way that this average error is minimised (brought as close to zero as possible).
                </p>
                <p style="text-align: justify;">
                    On a computer, the best automatic process of optimisation is called the gradient descent algorithm.
                    In very simple terms, the process involves going over each parameter and checking how the average error changes when the parameter is slightly increased and decreased.
                    If increasing the parameter's value decreases the average error, a note is made that the parameter needs to be increased; if decreasing the parameter's value is what decreases the average error, a note is made that the parameter needs to be decreased; if neither change decreases the error, a note is made that the parameter shouldn't be changed.
                    The parameter needs to then be restored to its original value before checking the next parameter.
                    Once all the parameters have been checked, they are then all changed at once.
                    Slightly changing all parameters at once is better than fully changing one parameter at a time, a process called coordinate descent, as it works on more complex problems that coordinate descent fails in.
                    A single step of parameter changes in gradient descent is called an epoch.
                </p>
                <p style="text-align: justify;">
                    Try performing an epoch yourself by using the buttons on the parameters and then use the big button below that automatically performs an epoch for you.
                    You need many epochs to fully train a neural network.
                </p>
            </td>
        </tr>
        <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td style="text-align: center; font-size: 20px;">Average error: <span id="faces_computer_error"><span></td>
        </tr>
        <tr>
            <td style="width: 170px;">
                <table class="attributes">
                    <tr><td style="text-align: right;">Input 1<br />(0 or 1)</td></tr>
                    <tr><td style="text-align: right;">Input 2<br />(0 or 1)</td></tr>
                    <tr><td style="text-align: right;">Input 3<br />(0 or 1)</td></tr>
                    <tr><td style="text-align: right;">Input 4<br />(0 or 1)</td></tr>
                </table>
            </td>
            <td style="width: 510px;">
                <div id="faces_computer_canvas" class="canvas"></div>
            </td>
            <td style="width: 305px;">
                <table class="faces">
                    <tr>
                        <td><div id="faces_computer_img1" class="box" style="font-size:14pt;"></div></td>
                        <td><div id="faces_computer_img2" class="box" style="font-size:14pt;"></div></td>
                    </tr>
                    <tr>
                        <td><div id="faces_computer_img3" class="box" style="font-size:14pt;"></div></td>
                        <td><div id="faces_computer_img4" class="box" style="font-size:14pt;"></div></td>
                    </tr>
                    <tr>
                        <td><div id="faces_computer_img5" class="box" style="font-size:14pt;"></div></td>
                        <td><div id="faces_computer_img6" class="box" style="font-size:14pt;"></div></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="3" style="text-align: center;"><input id="automate" type="button" value="Automatic epoch" style="font-size: 20pt;" /></td>
        </tr>
    </table>

    <hr />

    <p><a href="../index.html">Return to main page</a></p>

</body>
</html>